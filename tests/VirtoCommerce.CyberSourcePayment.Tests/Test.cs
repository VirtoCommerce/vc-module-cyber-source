using VirtoCommerce.CyberSourcePayment.Data.Services;
using Xunit;

namespace VirtoCommerce.CyberSourcePayment.Tests;

[Trait("Category", "Unit")]
public class JwtToken
{
    [Fact]
    public void DecodeJwtToJwtKeyModel()
    {
        var result = CyberSourceClient.DecodeJwtToJwtKeyModel("eyJraWQiOiJ6dSIsImFsZyI6IlJTMjU2In0.eyJmbHgiOnsicGF0aCI6Ii9mbGV4L3YyL3Rva2VucyIsImRhdGEiOiJGT09hVXdXaUI2bjJqTHdoLzhBTU1SQUFFQ050M3p5eWVic2tWMkwySlZ6cVVLRENmN2JoYTNmVmxucGNEZGJOTkRyVkIyditFVk15VlFodEk5TEZGc0RxZjNNQURHdUFxMHQ2Y29zbEJqREVXampwc1JVTlY2ZmhwZURCNDRnVVk3c1BnQzRqd2ROeUdETlQrV25nRFpub1dnXHUwMDNkXHUwMDNkIiwib3JpZ2luIjoiaHR0cHM6Ly90ZXN0ZmxleC5jeWJlcnNvdXJjZS5jb20iLCJqd2siOnsia3R5IjoiUlNBIiwiZSI6IkFRQUIiLCJ1c2UiOiJlbmMiLCJuIjoidGpSWC1SY0ZuNzVTWXFkY1VjMy1EdU9sR2Q1dnl0S29WQ1Y1M0MwTlJ4SVgxVWc5SzFEUFVVaWhFLWNvZHc2UE1KeS13U0Y2X3RjeTB6NmNYenFJdFM1TFlZMWIzb3pNTVBxcHl0RHItVmh5VEtwanhzdHQ0YlBIN0FmR3JPLTRDTkVLVmprT3dKb1FpNGl5OGwxVXoyZkJUT1FJV1pldTRBMVB6eUxVZlZUYTV0MUtUblEtU0lpYjRYYUtTTHJLYUhoUXdCLTZpbk1vUWVhLTZlbkNZR0hJSV9UNWVfSDJ4ODlTUjVtWkFfZG9DNEdlY0JuUndRVzJBaFk5aEZuSTNjVUIyd3dvdW9sWWtmRnhzemxhT2RfOXM2Nzhnekx0UnFoc2JwdXp5WUNDZ2oxdjUxQk1LdVpSdWNucmlGenMtMXltV21TRmFPeHBFeEhoLVMwd0p3Iiwia2lkIjoiMDg2SEVLUzZ2VkRHNHQyY3V6SGR2aWNJUGcxMDBoN0gifX0sImN0eCI6W3siZGF0YSI6eyJjbGllbnRMaWJyYXJ5SW50ZWdyaXR5Ijoic2hhMjU2LTRUVUtCZDNWTUlHR05zMVpMemZVNmJHMFlHNGtVU2NTT3RQdTVlYzdZZ29cdTAwM2QiLCJjbGllbnRMaWJyYXJ5IjoiaHR0cHM6Ly90ZXN0ZmxleC5jeWJlcnNvdXJjZS5jb20vbWljcm9mb3JtL2J1bmRsZS92Mi4wLjIvZmxleC1taWNyb2Zvcm0ubWluLmpzIiwiYWxsb3dlZENhcmROZXR3b3JrcyI6WyJWSVNBIiwiTUFTVEVSQ0FSRCIsIkFNRVgiLCJESVNDT1ZFUiIsIkRJTkVSU0NMVUIiLCJKQ0IiLCJDQVJURVNCQU5DQUlSRVMiLCJNQUVTVFJPIiwiQ1VQIl0sInRhcmdldE9yaWdpbnMiOlsiaHR0cHM6Ly92Y3N0LWRldi1zdG9yZWZyb250LmdvdmlydG8uY29tIl0sIm1mT3JpZ2luIjoiaHR0cHM6Ly90ZXN0ZmxleC5jeWJlcnNvdXJjZS5jb20ifSwidHlwZSI6Im1mLTIuMC4wIn1dLCJpc3MiOiJGbGV4IEFQSSIsImV4cCI6MTczNzUzODI2MiwiaWF0IjoxNzM3NTM3MzYyLCJqdGkiOiJDb3k0MTcwVkM0UkNQdFVOIn0.ISGgttdihRb6OJTLU0dBEmzJ7s7GST9QA3HtPMyCiZ-NJ60XilEzzK9DSq6WrP7tnPD0krVMXv5ZWgsqRec_U58KvwLhpSC4PprsBtLbmrX9ccgvWvdbEV3a48FcEW2G00U50ifxHIZUeuhEZOXU8bwcHwe3w0bwTTfiySrOHUnnQ_L0R_wATJRAKpxpk6BP1VLSuy00ihLrOxwBsbwNGdgZyY39fiW7MOvA7jIjIzPkFf9OuNBUzhC6ie3wSyimEfDrnsIDkx-djRtES4zIU-gr_IUSv7SZTdWCYLp60Udbeqxp4VDDAMLupUXZwIzoVFSc8Dd636Wx3vgVs3vmxg");

        Assert.Equal("086HEKS6vVDG4t2cuzHdvicIPg100h7H", result.KeyId);
        Assert.Equal("sha256-4TUKBd3VMIGGNs1ZLzfU6bG0YG4kUScSOtPu5ec7Ygo=", result.ClientLibraryIntegrity);
        Assert.Equal("https://testflex.cybersource.com/microform/bundle/v2.0.2/flex-microform.min.js", result.ClientLibrary);
    }
}
